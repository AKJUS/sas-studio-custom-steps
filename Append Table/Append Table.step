{"type":"code","name":"Append Table.step","displayName":"Append Table.step","description":"","templates":{"SAS":"/*==========================================================================* \n * Custom Step:     Append                                                  * \n * Transform:       Append                                                  * \n * Description:     This macro appends data to target table, optionally     *\n *                  maintaining an column with and unique incremental id    *\n *==========================================================================*/\n%macro append( force=\n\t\t\t,nowarn=\n\t\t\t,columnToAssignIncrementalId= \n\t\t\t);\n\t%if %sysfunc(exist(&outputtable1)) ne 1 %then %do;\n\t\t%let startId=0;\n\n\t\t/* Copy table as is */\n\t\tdata &outputtable1;\n\t\t\tset &inputtable1;\n\n\t\t\t%if %str(&columnToAssignIncrementalId) ne %str() %then %do;\n\t\t\t\tattrib &columnToAssignIncrementalId length=8 format=best.;\n\t\t\t\t&columnToAssignIncrementalId=&startId+_n_;\n\t\t\t%end;\n\t\trun;\n\n\t%end;\n\t%else %do;\n\n\t\t/* Determine startId */\n\t\t%if %str(&columnToAssignIncrementalId) ne %str() %then %do;\n\n\t\t\tproc sql noprint;\n\t\t\t\tselect max(&columnToAssignIncrementalId) into:startId\n\t\t\t\t\tfrom &outputtable1;\n\t\t\tquit;\n\n\t\t\t/* Create temp table with id */\n\t\t\tdata work.__appendUniqueId;\n\t\t\t\tset &inputtable1;\n\t\t\t\tattrib &columnToAssignIncrementalId length=8 format=best.;\n\t\t\t\t&columnToAssignIncrementalId=max(&startId,0)+_n_;\n\t\t\trun;\n\n\t\t\tproc append base=&outputtable1. \n\t\t\t\tdata=work.__appendUniqueId\n\t\t\t\t%if &force. = Yes %then \n\t\t\t\t\tforce;\n\t\t\t\t%if &nowarn. = Yes %then\n\t\t\t\t\tnowarn;;\n\t\t\trun;\n\n\t\t%end;\n\t\t%else %do;\n\n\t\t\tproc append base=&outputtable1. \n\t\t\t\tdata=&inputtable1.\n\t\t\t\t%if &force. = Yes %then \n\t\t\t\t\tforce;\n\t\t\t\t%if &nowarn. = Yes %then\n\t\t\t\t\tnowarn;;\n\t\t\trun;\n\n\t\t%end;\n\t%end;\n%mend append;\n\n%append( force=&force., nowarn=&nowarn., columnToAssignIncrementalId=&incrementalIdColumn_name);"},"properties":{},"ui":"{\n\t\"showPageContentOnly\": true,\n\t\"pages\": [\n\t\t{\n\t\t\t\"id\": \"inputPage\",\n\t\t\t\"type\": \"page\",\n\t\t\t\"label\": \"Append Table Settings\",\n\t\t\t\"children\": [\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"inputtable1\",\n\t\t\t\t\t\"type\": \"inputtable\",\n\t\t\t\t\t\"label\": \"Select an input table\",\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"placeholder\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"outputtable1\",\n\t\t\t\t\t\"type\": \"outputtable\",\n\t\t\t\t\t\"label\": \"Select an output table\",\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"placeholder\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"nowarn\",\n\t\t\t\t\t\"type\": \"dropdown\",\n\t\t\t\t\t\"label\": \"Suppress warning:\",\n\t\t\t\t\t\"items\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"Yes\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"No\"\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"placeholder\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"force\",\n\t\t\t\t\t\"type\": \"dropdown\",\n\t\t\t\t\t\"label\": \"Use force:\",\n\t\t\t\t\t\"items\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"Yes\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"No\"\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"placeholder\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"incrementalIdColumn\",\n\t\t\t\t\t\"type\": \"newcolumn\",\n\t\t\t\t\t\"label\": \"Column to keep track of incremental id (optional)\",\n\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\"hideproperties\": false,\n\t\t\t\t\t\"readonly\": false\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"id\": \"page1\",\n\t\t\t\"type\": \"page\",\n\t\t\t\"label\": \"About\",\n\t\t\t\"children\": [\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"text1\",\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"The \\\"Append Table\\\" Custom Step appends data to a target table. Optionally, it can maintain a column with a unique incremental id.\\n\\nUSER INTERFACE\\n\\n- Column to keep track of incremental id (optional): Enter the name of a column.\\n\\n- Use force: Add the FORCE option to the APPEND statement to concatenate data sets when the input data set contains variables that meet one of the following criteria:\\n    (a) Are not in the output data set\\n    (b)Do not have the same type as the variables in the input data set\\n    (c)Are longer than the variables in the input data set\\n\\n- Suppress warning: Add the NOWARN option to the APPEND statement to suppress the warning when used with the FORCE option to concatenate two data sets with different variables.\\n\\n- Input Port: Table with data to be appended to the output table.\\n\\n- Output Port:  Table to append new data to. If this table does not exist, the input table will be copied as the output table.\\n\\nVersion 1.0 (26OCT2022)\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t],\n\t\"syntaxversion\": \"1.3.0\",\n\t\"values\": {\n\t\t\"inputtable1\": {\n\t\t\t\"library\": \"\",\n\t\t\t\"table\": \"\"\n\t\t},\n\t\t\"nowarn\": {\n\t\t\t\"value\": \"No\"\n\t\t},\n\t\t\"force\": {\n\t\t\t\"value\": \"No\"\n\t\t},\n\t\t\"incrementalIdColumn\": {\n\t\t\t\"value\": \"id\",\n\t\t\t\"type\": \"n\"\n\t\t}\n\t}\n}","flowMetadata":{"inputPorts":[{"name":"inputtable1","displayName":"inputtable1","minEntries":1,"maxEntries":1,"type":"table"}],"outputPorts":[{"name":"outputtable1","displayName":"outputtable1","description":"","minEntries":1,"maxEntries":1,"columnDelta":{"automaticMapping":[{"inputPort":"inputtable1"}],"removeColumnArguments":[],"keepColumnArguments":[],"updateColumnArguments":["incrementalIdColumn"]},"type":"table"}]}}