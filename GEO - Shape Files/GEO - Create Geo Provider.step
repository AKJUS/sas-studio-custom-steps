{"creationTimeStamp":"2024-03-19T10:36:46.009Z","modifiedTimeStamp":"2024-04-18T09:21:01.964Z","createdBy":"itastu","modifiedBy":"itastu","name":"GEO - Create Geo Provider.step","displayName":"GEO - Create Geo Provider.step","localDisplayName":"GEO - Create Geo Provider.step","properties":{},"links":[{"method":"GET","rel":"self","href":"/dataFlows/steps/7ad33b83-cc4b-478e-a3f9-9073809fe3bb","uri":"/dataFlows/steps/7ad33b83-cc4b-478e-a3f9-9073809fe3bb","type":"application/vnd.sas.data.flow.step"},{"method":"GET","rel":"alternate","href":"/dataFlows/steps/7ad33b83-cc4b-478e-a3f9-9073809fe3bb","uri":"/dataFlows/steps/7ad33b83-cc4b-478e-a3f9-9073809fe3bb","type":"application/vnd.sas.data.flow.step.summary"},{"method":"GET","rel":"up","href":"/dataFlows/steps","uri":"/dataFlows/steps","type":"application/vnd.sas.collection","itemType":"application/vnd.sas.data.flow.step.summary"},{"method":"PUT","rel":"update","href":"/dataFlows/steps/7ad33b83-cc4b-478e-a3f9-9073809fe3bb","uri":"/dataFlows/steps/7ad33b83-cc4b-478e-a3f9-9073809fe3bb","type":"application/vnd.sas.data.flow.step","responseType":"application/vnd.sas.data.flow.step"},{"method":"DELETE","rel":"delete","href":"/dataFlows/steps/7ad33b83-cc4b-478e-a3f9-9073809fe3bb","uri":"/dataFlows/steps/7ad33b83-cc4b-478e-a3f9-9073809fe3bb"},{"method":"GET","rel":"transferExport","href":"/dataFlows/steps/7ad33b83-cc4b-478e-a3f9-9073809fe3bb","uri":"/dataFlows/steps/7ad33b83-cc4b-478e-a3f9-9073809fe3bb","responseType":"application/vnd.sas.transfer.object"},{"method":"PUT","rel":"transferImportUpdate","href":"/dataFlows/steps/7ad33b83-cc4b-478e-a3f9-9073809fe3bb","uri":"/dataFlows/steps/7ad33b83-cc4b-478e-a3f9-9073809fe3bb","type":"application/vnd.sas.transfer.object","responseType":"application/vnd.sas.summary"}],"metadataVersion":0.0,"version":2,"type":"code","flowMetadata":{"inputPorts":[{"name":"inputtable1","displayName":"inputtable1","localDisplayName":"inputtable1","minEntries":1,"maxEntries":1,"defaultEntries":0,"type":"table"}],"outputPorts":[]},"ui":"{\n\t\"showPageContentOnly\": true,\n\t\"pages\": [\n\t\t{\n\t\t\t\"id\": \"page1\",\n\t\t\t\"type\": \"page\",\n\t\t\t\"label\": \"Parameters\",\n\t\t\t\"children\": [\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"inputtable1\",\n\t\t\t\t\t\"type\": \"inputtable\",\n\t\t\t\t\t\"label\": \"Input Table:\",\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"Name\",\n\t\t\t\t\t\"type\": \"textfield\",\n\t\t\t\t\t\"label\": \"Insert the name for the GEO Provider:\",\n\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"Label\",\n\t\t\t\t\t\"type\": \"textfield\",\n\t\t\t\t\t\"label\": \"Insert the label for the GEO Provider:\",\n\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"type\",\n\t\t\t\t\t\"type\": \"radiogroup\",\n\t\t\t\t\t\"label\": \"Select the Type of GEO Provider:\",\n\t\t\t\t\t\"items\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"casTableReference\"\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"geometryType\",\n\t\t\t\t\t\"type\": \"radiogroup\",\n\t\t\t\t\t\"label\": \"Select the Geometry Type:\",\n\t\t\t\t\t\"items\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"polygon\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"polyline\"\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"idColumn\",\n\t\t\t\t\t\"type\": \"columnselector\",\n\t\t\t\t\t\"label\": \"Select the ID Column for the GEO Provider:\",\n\t\t\t\t\t\"order\": false,\n\t\t\t\t\t\"columntype\": \"a\",\n\t\t\t\t\t\"max\": 1,\n\t\t\t\t\t\"min\": 1,\n\t\t\t\t\t\"visible\": \"\",\n\t\t\t\t\t\"table\": \"inputtable1\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"sequenceColumn\",\n\t\t\t\t\t\"type\": \"columnselector\",\n\t\t\t\t\t\"label\": \"Select the SEQUENCE Column for the GEO Provider:\",\n\t\t\t\t\t\"order\": false,\n\t\t\t\t\t\"columntype\": \"a\",\n\t\t\t\t\t\"max\": 1,\n\t\t\t\t\t\"min\": 1,\n\t\t\t\t\t\"visible\": \"\",\n\t\t\t\t\t\"table\": \"inputtable1\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"xColumn\",\n\t\t\t\t\t\"type\": \"columnselector\",\n\t\t\t\t\t\"label\": \"Select the X Column for the GEO Provider:\",\n\t\t\t\t\t\"order\": false,\n\t\t\t\t\t\"columntype\": \"a\",\n\t\t\t\t\t\"max\": 1,\n\t\t\t\t\t\"min\": 1,\n\t\t\t\t\t\"visible\": \"\",\n\t\t\t\t\t\"table\": \"inputtable1\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"yColumn\",\n\t\t\t\t\t\"type\": \"columnselector\",\n\t\t\t\t\t\"label\": \"Select the Y Column for the GEO Provider:\",\n\t\t\t\t\t\"order\": false,\n\t\t\t\t\t\"columntype\": \"a\",\n\t\t\t\t\t\"max\": 1,\n\t\t\t\t\t\"min\": 1,\n\t\t\t\t\t\"visible\": \"\",\n\t\t\t\t\t\"table\": \"inputtable1\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"segmentColumn\",\n\t\t\t\t\t\"type\": \"columnselector\",\n\t\t\t\t\t\"label\": \"Select the SEGMENT Column for the GEO Provider:\",\n\t\t\t\t\t\"order\": false,\n\t\t\t\t\t\"columntype\": \"a\",\n\t\t\t\t\t\"max\": 1,\n\t\t\t\t\t\"min\": 1,\n\t\t\t\t\t\"visible\": \"\",\n\t\t\t\t\t\"table\": \"inputtable1\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"filecoordinate\",\n\t\t\t\t\t\"type\": \"path\",\n\t\t\t\t\t\"label\": \"Select the .prj file containing the coordinate Space to assign to the GEO Provider:\",\n\t\t\t\t\t\"pathtype\": \"file\",\n\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"id\": \"page2\",\n\t\t\t\"type\": \"page\",\n\t\t\t\"label\": \"About\",\n\t\t\t\"children\": [\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"text1\",\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"Create Geo Provider\\n===============\\n\\nThis custom step can be used to create a Geographic Data Provider in SAS Visual Analytics interface.\\n\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"sectionPrereqs\",\n\t\t\t\t\t\"type\": \"section\",\n\t\t\t\t\t\"label\": \"PRE-REQUISITES\",\n\t\t\t\t\t\"open\": true,\n\t\t\t\t\t\"visible\": \"\",\n\t\t\t\t\t\"children\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"textPrereqs\",\n\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\"text\": \"This custom step must be used after the \\\"ShapePromote\\\" custom step.\\nIt can be connected to the output table of \\\"Import Shape\\\" or \\\"Apply Shape Reduce\\\", in this way the user can select the variables from drop-down lists.\",\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"USERINTERFACE\",\n\t\t\t\t\t\"type\": \"section\",\n\t\t\t\t\t\"label\": \"USER INTERFACE\",\n\t\t\t\t\t\"open\": true,\n\t\t\t\t\t\"visible\": \"\",\n\t\t\t\t\t\"children\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"text3\",\n\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\"text\": \"Insert the NAME and CASLIB of the table that must be used for the GEO Provider.\\n\\nInsert NAME and LABEL for the provider. If the name is already in use the process will fail.\\n\\nSelect the Geometry Type\\nPolygon if the file shp refears to a region visualization\\nPolylines if the file shp refears to a line visualization\\n\\nInsert the name of:\\nID, SEQUENCE, X, Y, SEGMENT.\\n\\nIn the box for the coordinate space select the .prj file containing the coordinate space to assign to the GEO Provider\",\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"NOTES\",\n\t\t\t\t\t\"type\": \"section\",\n\t\t\t\t\t\"label\": \"PLEASE NOTE\",\n\t\t\t\t\t\"open\": true,\n\t\t\t\t\t\"visible\": \"\",\n\t\t\t\t\t\"children\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"text4\",\n\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\"text\": \"This custom step requires the user to have rights to create the Geo Provider.\",\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"sectionDocumentation\",\n\t\t\t\t\t\"type\": \"section\",\n\t\t\t\t\t\"label\": \"Documentation\",\n\t\t\t\t\t\"open\": false,\n\t\t\t\t\t\"visible\": \"\",\n\t\t\t\t\t\"children\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"textDocumentation\",\n\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\"text\": \"Create a Geography Data Item By Using Custom Polygonal Shapes, Lines, or Coordinates from a Geographic Data Provider\\n\\nhttps://go.documentation.sas.com/doc/en/vacdc/v_023/vareportdata/p031vp9uc5y5iun0zipy3c1trkqn.htm#p08rpn6wxwstmen1hatk1f2qcndt\",\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"ChangeLog\",\n\t\t\t\t\t\"type\": \"section\",\n\t\t\t\t\t\"label\": \"Change Log\",\n\t\t\t\t\t\"open\": false,\n\t\t\t\t\t\"visible\": \"\",\n\t\t\t\t\t\"children\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"text2\",\n\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\"text\": \"- Version 1.1 (18APR2024)\\n    - Code Updated\\n\",\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t],\n\t\"syntaxversion\": \"1.3.0\",\n\t\"values\": {\n\t\t\"inputtable1\": {\n\t\t\t\"library\": \"\",\n\t\t\t\"table\": \"\"\n\t\t},\n\t\t\"Name\": \"\",\n\t\t\"Label\": \"\",\n\t\t\"type\": {\n\t\t\t\"value\": \"casTableReference\"\n\t\t},\n\t\t\"geometryType\": {\n\t\t\t\"value\": \"polygon\"\n\t\t},\n\t\t\"idColumn\": [],\n\t\t\"sequenceColumn\": [\n\t\t\t{\n\t\t\t\t\"value\": \"__seq__\"\n\t\t\t}\n\t\t],\n\t\t\"xColumn\": [\n\t\t\t{\n\t\t\t\t\"value\": \"X\"\n\t\t\t}\n\t\t],\n\t\t\"yColumn\": [\n\t\t\t{\n\t\t\t\t\"value\": \"Y\"\n\t\t\t}\n\t\t],\n\t\t\"segmentColumn\": [],\n\t\t\"filecoordinate\": \"\"\n\t}\n}","templates":{"SAS":"/* Put the body of the JSON content in external file */\nFILENAME ADD_OUT TEMP ENCODING='UTF-8';\nFILENAME ADD_hd TEMP ENCODING='UTF-8';\n\n%let CASLIB = %scan(&inputtable1,1,'.');\n%put CASLIB = &CASLIB;\n\n%let TABLE = %scan(&inputtable1,2,'.');\n%put TABLE = &TABLE;\n\n%LET casTableUri = %STR(/servers/cas-shared-default/caslibs/&CASLIB/tables/&TABLE);\n\n%PUT name            = &name            ;\n%PUT label           = &label           ;\n%PUT type            = &type            ;\n%PUT casTableUri     = &casTableUri     ;\n%PUT coordinate \t = &coordinate \t\t;\n%PUT filecoordinate  = &filecoordinate \t;\n%PUT geometryType    = &geometryType    ;\n%PUT idColumn        = &idColumn        ;\n%PUT segmentColumn   = &segmentColumn   ;\n%PUT sequenceColumn  = &sequenceColumn  ;\n%PUT xColumn         = &xColumn         ;\n%PUT yColumn         = &yColumn         ;\n\n%let Proj = %Scan(&filecoordinate,2,':');\n%put PRJ = &Proj;\n\ndata work.projection;\ninfile \"&Proj\" truncover scanover;\nformat Projection $10000.;\ninput  Projection $10000.;\ncall symput('coordinate',%trim(Projection));\nrun;\n\n%LET coordinateSpace1  = %sysfunc(tranwrd(%quote(&coordinate),%str(%\"),%str(\\%%%\")));\n%PUT &coordinateSpace1;\n\n%let IN =  %STR({ %\"name%\": %\"&name.%\" , \n\t%\"label%\": %\"&label.%\" , \n\t%\"type%\": %\"&type.%\" ,\n\t%\"geometryType%\": %\"&geometryType.%\" ,\n\t%\"casTableUri%\": %\"&casTableUri.%\" ,\n\t%\"idColumn%\": %\"&idColumn.%\" ,\n\t%\"sequenceColumn%\": %\"&sequenceColumn.%\" ,\n\t%\"xColumn%\": %\"&xColumn.%\" ,\n\t%\"yColumn%\": %\"&yColumn.%\" ,\n\t%\"segmentColumn%\": %\"&segmentColumn.%\" ,\n\t%\"coordinateSpace%\": %\"&coordinateSpace1.%\" } );\n%put IN = &IN;\n\n/*Create the provider*/\n\n%let BASE_URI=%sysfunc(getoption(SERVICESBASEURL));\n\nPROC HTTP METHOD=\"POST\" oauth_bearer=sas_services OUT=ADD_OUT headerout=ADD_hd\n\tURL = \"&BASE_URI/maps/providers\"\n\tIN=%QUOTE(\"&IN\");\n    HEADERS \"Accept\" = \"application/vnd.sas.maps.provider+json\"\n\t\t\t\"Content-Type\" = \"application/json\" ;\n/* debug level=3; */\nRUN;\n\nproc delete data=work.projection; run;"}}