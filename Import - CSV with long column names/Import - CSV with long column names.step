{"creationTimeStamp":"2023-12-21T06:10:35.415Z","modifiedTimeStamp":"2024-01-15T12:15:34.266Z","createdBy":"ignacio","modifiedBy":"ignacio","name":"Import - CSV with long column names.step","displayName":"Import - CSV with long column names.step","localDisplayName":"Import - CSV with long column names.step","properties":{},"links":[{"method":"GET","rel":"self","href":"/dataFlows/steps/a8cee622-7b6d-4b3b-babc-3fce05c39be2","uri":"/dataFlows/steps/a8cee622-7b6d-4b3b-babc-3fce05c39be2","type":"application/vnd.sas.data.flow.step"},{"method":"GET","rel":"alternate","href":"/dataFlows/steps/a8cee622-7b6d-4b3b-babc-3fce05c39be2","uri":"/dataFlows/steps/a8cee622-7b6d-4b3b-babc-3fce05c39be2","type":"application/vnd.sas.data.flow.step.summary"},{"method":"GET","rel":"up","href":"/dataFlows/steps","uri":"/dataFlows/steps","type":"application/vnd.sas.collection","itemType":"application/vnd.sas.data.flow.step.summary"},{"method":"PUT","rel":"update","href":"/dataFlows/steps/a8cee622-7b6d-4b3b-babc-3fce05c39be2","uri":"/dataFlows/steps/a8cee622-7b6d-4b3b-babc-3fce05c39be2","type":"application/vnd.sas.data.flow.step","responseType":"application/vnd.sas.data.flow.step"},{"method":"DELETE","rel":"delete","href":"/dataFlows/steps/a8cee622-7b6d-4b3b-babc-3fce05c39be2","uri":"/dataFlows/steps/a8cee622-7b6d-4b3b-babc-3fce05c39be2"},{"method":"GET","rel":"transferExport","href":"/dataFlows/steps/a8cee622-7b6d-4b3b-babc-3fce05c39be2","uri":"/dataFlows/steps/a8cee622-7b6d-4b3b-babc-3fce05c39be2","responseType":"application/vnd.sas.transfer.object"},{"method":"PUT","rel":"transferImportUpdate","href":"/dataFlows/steps/a8cee622-7b6d-4b3b-babc-3fce05c39be2","uri":"/dataFlows/steps/a8cee622-7b6d-4b3b-babc-3fce05c39be2","type":"application/vnd.sas.transfer.object","responseType":"application/vnd.sas.summary"}],"metadataVersion":0.0,"version":2,"type":"code","flowMetadata":{"inputPorts":[],"outputPorts":[{"name":"outputTable_data","displayName":"outputTable_data","localDisplayName":"outputTable_data","minEntries":1,"maxEntries":1,"defaultEntries":0,"type":"table","supportsView":false,"requiresStructure":false}]},"ui":"{\n\t\"showPageContentOnly\": true,\n\t\"pages\": [\n\t\t{\n\t\t\t\"id\": \"pgoptions\",\n\t\t\t\"type\": \"page\",\n\t\t\t\"label\": \"Options\",\n\t\t\t\"children\": [\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"infile_origfile\",\n\t\t\t\t\t\"type\": \"path\",\n\t\t\t\t\t\"label\": \"Select the input file:\",\n\t\t\t\t\t\"pathtype\": \"file\",\n\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"text3\",\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"Note: The column name will be used as label in the output table\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"radiogrp_col2lab_delimiter\",\n\t\t\t\t\t\"type\": \"radiogroup\",\n\t\t\t\t\t\"label\": \"Delimiter:\",\n\t\t\t\t\t\"items\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"tab\",\n\t\t\t\t\t\t\t\"label\": \"Tab\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"other\",\n\t\t\t\t\t\t\t\"label\": \"Other\"\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"inttxt_col2lab_del\",\n\t\t\t\t\t\"type\": \"textfield\",\n\t\t\t\t\t\"label\": \"Delimiter character:\",\n\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\"visible\": [\n\t\t\t\t\t\t\"$radiogrp_col2lab_delimiter\",\n\t\t\t\t\t\t\"=\",\n\t\t\t\t\t\t\"other\"\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"outputTable_data\",\n\t\t\t\t\t\"type\": \"outputtable\",\n\t\t\t\t\t\"label\": \"Output table:\",\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"id\": \"pgabout\",\n\t\t\t\"type\": \"page\",\n\t\t\t\"label\": \"About\",\n\t\t\t\"children\": [\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"outtxtAbout\",\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"Import - CSV with long column names\\n==========================\\n\\nThis custom step provides an easy way to import a CSV (or any other delimited file) with column names longer than 32 characters. It will abbreviate column names in the first row of the CSV so they adhere to 32-char restrictions, and then generate label statements with the original long column name.\\n\\nKnown issues are described in the README file for this custom step available in GitHub (https://github.com/sassoftware/sas-studio-custom-steps/tree/main/Import%20-%20CSV%20with%20long%20column%20names).\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"secDocumentation\",\n\t\t\t\t\t\"type\": \"section\",\n\t\t\t\t\t\"label\": \"Documentation\",\n\t\t\t\t\t\"open\": false,\n\t\t\t\t\t\"children\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"outtxtDocumentation\",\n\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\"text\": \"\",\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"secPreReq\",\n\t\t\t\t\t\"type\": \"section\",\n\t\t\t\t\t\"label\": \"Pre-requisites\",\n\t\t\t\t\t\"open\": false,\n\t\t\t\t\t\"children\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"outtxtPreReq\",\n\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\"text\": \"This custom step has been tested on SAS Viya version Stable 2023.11.\",\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"secChangeLog\",\n\t\t\t\t\t\"type\": \"section\",\n\t\t\t\t\t\"label\": \"Change Log\",\n\t\t\t\t\t\"open\": false,\n\t\t\t\t\t\"children\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"outtxtChangeLog\",\n\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\"text\": \"* Version 1.01 (15JAN2024)\\n  - Added section: Known issues\\n\\n* Version 1.0 (21DEC2023)\\n  - Initial release\",\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t],\n\t\"syntaxversion\": \"1.3.0\",\n\t\"values\": {\n\t\t\"infile_origfile\": \"\",\n\t\t\"radiogrp_col2lab_delimiter\": {\n\t\t\t\"value\": \"tab\",\n\t\t\t\"label\": \"Tab\"\n\t\t},\n\t\t\"inttxt_col2lab_del\": \",\",\n\t\t\"outputTable_data\": {\n\t\t\t\"library\": \"\",\n\t\t\t\"table\": \"\"\n\t\t}\n\t}\n}","templates":{"SAS":"/***********************************************************************\n \nCustom Step for importing a CSV with long column names\n\n***********************************************************************/\n\n%macro importcsv();\n\n    filename labels temp;\n    %let locationType=%sysfunc(scan(&infile_origfile,1,:,M));\n    %let fullpath=%sysfunc(scan(&infile_origfile,2,:,M));\n    %if &locationType=sascontent %then %do;\n        %let file = %scan(&fullpath., -1, '/');\n        %let path = %substr(&fullpath.,1,%length(&fullpath.)-%length(&file.));\n        filename reffile filesrvc folderpath=\"&path.\" filename=\"&file.\" lrecl=32767;\n    %end;\n    %else %if &locationType=sasserver %then %do;\n        filename reffile disk \"&fullpath.\" lrecl=32767;\n    %end;\n\n    %if &radiogrp_col2lab_delimiter=tab %then %do;\n        options validvarname=v7;\n        proc import datafile=reffile dbms=tab out=&outputTable_data. replace;\n        run;\n        options validvarname=any;\n    %end;\n    %else %if &radiogrp_col2lab_delimiter=other %then %do;\n        options validvarname=v7;\n        proc import datafile=reffile dbms=dlm out=&outputTable_data. replace;\n            delimiter=\"&inttxt_col2lab_del.\";\n        run;\n        options validvarname=any;\n    %end;\n\n    proc transpose data=&outputTable_data.(obs=0) out=work.temp;\n        var _all_;\n    run;\n\n    filename code temp;\n\n    data work.temp;\n        length _name_ $32 _label_ $256 ;\n        set work.temp;\n        infile reffile dsd truncover obs=1;\n        input _label_ @@;\n        file code;\n        put \"label '\" _name_  \"'n=\" _label_ :$quote. \";\" ;\n    run;\n\n    proc datasets nolist lib=&outputTable_data_lib.;\n        modify &outputTable_data_name.;\n        %include code / source2;\n    run;\n\n    proc delete data=work.temp;\n    run;\n\n    filename code clear;\n    filename reffile clear; \n\n%mend importcsv;\n\n%importcsv();"}}