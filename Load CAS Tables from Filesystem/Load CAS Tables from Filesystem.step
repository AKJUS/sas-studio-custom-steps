{"type":"code","name":"Load CAS Tables from Filesystem.step","displayName":"Load CAS Tables from Filesystem.step","description":"","templates":{"SAS":"/* SAS templated code goes here */\n\ndata _null_;\n\tcall symput(\"folderrr\",scan(\"&folderr.\",2,\":\",\"MO\"));\nrun;\n\n\n%if \"&fType.\"=\"ALL\" %then %do;\n\tdata _NULL_;\n\t\tcall symput(\"fType\",\"%\");\n\trun;\n%end;\n\n\n/* FUTURE PLACEHOLDER: Accommodate multiple filetypes (i.e. between 1 single file type and ALL) */\n\n\nproc cas;\n\nfunction loadd(tab);\n\ttabname=scan(tab,1,\".\",\"MO\");\n\t%IF &PROMOTEFLAG=0 %THEN %DO;\n\t\ttable.loadTable /\n\t\t\tcaslib=\"data\"\n\t\t\tpath=tab\n\t\t\tcasout={caslib=\"&outcaslibb.\", replace=True}\n\t;\n\t%END;\n\t%ELSE %DO;\n\t\ttable.tableExists  result=rc/\n\t   \t\tname=tabname\n\t\t\tcaslib=\"&outcaslibb.\"\n\t;\n\t\tdo until (rc.exists=0);\n\t\t   table.dropTable /\n\t\t         name=tabname\n\t\t\t\t caslib=\"&outcaslibb.\"\n\t\t         ;\n\t\t   table.tableExists  result=rc/\n\t\t\t\tname=tabname\n\t\t\t\tcaslib=\"&outcaslibb.\"\n\t\t\t\t;\n\t\tend;\n\t\ttable.loadTable /\n\t\t\tcaslib=\"data\"\n\t\t\tpath=tab\n\t\t\tcasout={caslib=\"&outcaslibb.\", promote=True}\n\t;\n\t%END;\n/* FUTURE PLACEHOLDER: Insert a check for successful load */\n\tReturn(tab||\" loaded\");\nend;\n\ntable.addcaslib /\n\tname=\"data\",\n    dataSource={srcType=\"path\"},\n    path=\"&folderrr.\"\n;\n\ntable.fileInfo result = r/\n\tcaslib=\"data\"\n\tpath='%'||\"&patternn.\"||'%'||\"&ftype.\"\n\twildsensitive=false\n;\n\nrr = r[1];\nrrr = rr.compute(\"LoadStatus\",loadd(Name));\n\nquit;\n"},"properties":{},"ui":"{\n\t\"showPageContentOnly\": true,\n\t\"pages\": [\n\t\t{\n\t\t\t\"id\": \"page1\",\n\t\t\t\"type\": \"page\",\n\t\t\t\"label\": \"Parameters\",\n\t\t\t\"children\": [\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"text2\",\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"Load CAS Tables from Filesystem\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"folderr\",\n\t\t\t\t\t\"type\": \"path\",\n\t\t\t\t\t\"label\": \"Select Folder containing Input Data\",\n\t\t\t\t\t\"pathtype\": \"folder\",\n\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"outcaslibb\",\n\t\t\t\t\t\"type\": \"textfield\",\n\t\t\t\t\t\"label\": \"Provide Output Global Caslib\",\n\t\t\t\t\t\"placeholder\": \"Default is PUBLIC\",\n\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"promoteFlag\",\n\t\t\t\t\t\"type\": \"checkbox\",\n\t\t\t\t\t\"label\": \"Promote All Tables\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"fType\",\n\t\t\t\t\t\"type\": \"radiogroup\",\n\t\t\t\t\t\"label\": \"Select File Type (extension)\",\n\t\t\t\t\t\"items\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"csv\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"txt\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"sashdat\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"sav\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"xls\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"jmp\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"ALL\"\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"patternn\",\n\t\t\t\t\t\"type\": \"textfield\",\n\t\t\t\t\t\"label\": \"Pattern (leave blank if not needed)\",\n\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"id\": \"page2\",\n\t\t\t\"type\": \"page\",\n\t\t\t\"label\": \"About\",\n\t\t\t\"children\": [\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"text1\",\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"Load CAS Tables from Filesystem\\n\\nThe \\\"Load CAS Tables from Filesystem\\\" custom step loads all files of a specified pattern located within a folder to in-memory Cloud Analytics Services (CAS) tables. Every file within the folder is loaded to a separate table with the same name (without the suffix).\\n\\nThis custom step is useful for applications where the user wishes to load multiple files to load to CAS in one go.  A specific application where this proves useful is when you would use source code and data located within a Git repository.  After cloning the repo using Git Integration, you can then run this step to load all required data to CAS tables.\\n\\nInput parameters for this custom step are : \\n\\n1. Select the folder containing your input data on the Filesystem.\\n2. Provide an output CASLIB name (PUBLIC is the default).\\n3. The default behaviour is to promote the CAS table upon load.  Uncheck this box if you wish to use this table only within a SAS Studio session.\\n4. As an option, you may choose to filter on a specific file extension.  A future enhancement will allow you to select multiple extensions.  For now, select either one extension, or ALL.\\n5. As an option, you may like to provide a wildcard pattern which only loads files whose names conform to the said pattern. Feel free to leave this blank.\\n\\nThe number of output datasets may vary, depending on the number of files you have in your selected folder. To check the status of the load, you may either refer to the Libraries tab in SAS Studio (left menu bar) or you may like to check using Manage Data / Prepare Data in the main menu.  You may also choose to select these output table for visualization using SAS Visual Analytics.\\n\\nRefer SAS documentation for information on the actions used in this custom step.\\n\\nfileInfo : https://documentation.sas.com/?cdcId=sasstudiocdc&cdcVersion=default&activeCdc=pgmsascdc&docsetId=caspg&docsetTarget=cas-table-fileinfo.htm\\n\\nloadTable : https://documentation.sas.com/?cdcId=sasstudiocdc&cdcVersion=default&activeCdc=pgmsascdc&docsetId=caspg&docsetTarget=cas-table-loadtable.htm\\n\\nCreated / contact : Sundaresh Sankaran (sundaresh.sankaran@sas.com) \\n\\nVersion : 1.0.   (09DEC2022)\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t],\n\t\"syntaxversion\": \"1.3.0\",\n\t\"values\": {\n\t\t\"folderr\": \"\",\n\t\t\"outcaslibb\": \"PUBLIC\",\n\t\t\"promoteFlag\": true,\n\t\t\"fType\": {\n\t\t\t\"value\": \"ALL\"\n\t\t},\n\t\t\"patternn\": \"\"\n\t}\n}","flowMetadata":{"inputPorts":[],"outputPorts":[]}}