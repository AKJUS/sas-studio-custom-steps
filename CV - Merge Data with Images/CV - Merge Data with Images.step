{"creationTimeStamp":"2024-04-12T20:05:17.546Z","modifiedTimeStamp":"2024-09-19T18:23:20.846Z","createdBy":"roblan","modifiedBy":"roblan","name":"CV - Merge Data with Images.step","displayName":"CV - Merge Data with Images.step","localDisplayName":"CV - Merge Data with Images.step","properties":{},"links":[{"method":"GET","rel":"self","href":"/dataFlows/steps/690fcab1-50f6-4f05-bfb7-77561f0b815a","uri":"/dataFlows/steps/690fcab1-50f6-4f05-bfb7-77561f0b815a","type":"application/vnd.sas.data.flow.step"},{"method":"GET","rel":"alternate","href":"/dataFlows/steps/690fcab1-50f6-4f05-bfb7-77561f0b815a","uri":"/dataFlows/steps/690fcab1-50f6-4f05-bfb7-77561f0b815a","type":"application/vnd.sas.data.flow.step.summary"},{"method":"GET","rel":"up","href":"/dataFlows/steps","uri":"/dataFlows/steps","type":"application/vnd.sas.collection","itemType":"application/vnd.sas.data.flow.step.summary"},{"method":"PUT","rel":"update","href":"/dataFlows/steps/690fcab1-50f6-4f05-bfb7-77561f0b815a","uri":"/dataFlows/steps/690fcab1-50f6-4f05-bfb7-77561f0b815a","type":"application/vnd.sas.data.flow.step","responseType":"application/vnd.sas.data.flow.step"},{"method":"DELETE","rel":"delete","href":"/dataFlows/steps/690fcab1-50f6-4f05-bfb7-77561f0b815a","uri":"/dataFlows/steps/690fcab1-50f6-4f05-bfb7-77561f0b815a"},{"method":"POST","rel":"copy","href":"/dataFlows/steps/690fcab1-50f6-4f05-bfb7-77561f0b815a/copy","uri":"/dataFlows/steps/690fcab1-50f6-4f05-bfb7-77561f0b815a/copy","responseType":"application/vnd.sas.data.flow.step"},{"method":"GET","rel":"transferExport","href":"/dataFlows/steps/690fcab1-50f6-4f05-bfb7-77561f0b815a","uri":"/dataFlows/steps/690fcab1-50f6-4f05-bfb7-77561f0b815a","responseType":"application/vnd.sas.transfer.object"},{"method":"PUT","rel":"transferImportUpdate","href":"/dataFlows/steps/690fcab1-50f6-4f05-bfb7-77561f0b815a","uri":"/dataFlows/steps/690fcab1-50f6-4f05-bfb7-77561f0b815a","type":"application/vnd.sas.transfer.object","responseType":"application/vnd.sas.summary"}],"metadataVersion":0.0,"version":2,"type":"code","flowMetadata":{"inputPorts":[{"name":"_Annotationtbl_","displayName":"_Annotationtbl_","localDisplayName":"_Annotationtbl_","minEntries":1,"maxEntries":1,"defaultEntries":0,"type":"table"},{"name":"_inImgtbl_","displayName":"_inImgtbl_","localDisplayName":"_inImgtbl_","minEntries":1,"maxEntries":1,"defaultEntries":0,"type":"table"}],"outputPorts":[{"name":"insert_outtabname","displayName":"insert_outtabname","localDisplayName":"insert_outtabname","minEntries":1,"maxEntries":1,"defaultEntries":0,"type":"table","supportsView":false,"requiresStructure":false}]},"ui":"{\n\t\"showPageContentOnly\": true,\n\t\"pages\": [\n\t\t{\n\t\t\t\"id\": \"DataPage\",\n\t\t\t\"type\": \"page\",\n\t\t\t\"label\": \"Data\",\n\t\t\t\"children\": [\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"text2\",\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"Join type:\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"_jointypeoption_\",\n\t\t\t\t\t\"type\": \"dropdown\",\n\t\t\t\t\t\"label\": \"\",\n\t\t\t\t\t\"items\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"APPEND\",\n\t\t\t\t\t\t\t\"label\": \"Append\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"FULL\",\n\t\t\t\t\t\t\t\"label\": \"Full\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"INNER\",\n\t\t\t\t\t\t\t\"label\": \"Inner\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"LEFT\",\n\t\t\t\t\t\t\t\"label\": \"Left\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"RIGHT\",\n\t\t\t\t\t\t\t\"label\": \"RIGHT\"\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"text1\",\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"Name of variable to use for the join (merge): \",\n\t\t\t\t\t\"visible\": [\n\t\t\t\t\t\t\"$_jointypeoption_\",\n\t\t\t\t\t\t\"!=\",\n\t\t\t\t\t\t\"APPEND\"\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"_insert_varjoin\",\n\t\t\t\t\t\"type\": \"textfield\",\n\t\t\t\t\t\"label\": \"\",\n\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\"visible\": [\n\t\t\t\t\t\t\"$_jointypeoption_\",\n\t\t\t\t\t\t\"!=\",\n\t\t\t\t\t\t\"APPEND\"\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"_Annotationtbl_\",\n\t\t\t\t\t\"type\": \"inputtable\",\n\t\t\t\t\t\"label\": \"Annotation table:\",\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"insert_outtabname\",\n\t\t\t\t\t\"type\": \"outputtable\",\n\t\t\t\t\t\"label\": \"Output table:\",\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"_inImgtbl_\",\n\t\t\t\t\t\"type\": \"inputtable\",\n\t\t\t\t\t\"label\": \"Image table:\",\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"id\": \"page1\",\n\t\t\t\"type\": \"page\",\n\t\t\t\"label\": \"About\",\n\t\t\t\"children\": [\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"about_text\",\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"Computer Vision (CV) - Merge Data with Images\\n=================================\\n\\nThis custom step allows users to merge or append data together that contains images. Common uses are:\\n1)\\tMerging images with labels\\n2)\\tAppending dataset together to create larger image processing datasets.\\nThis custom step uses the dljoin action whoâ€™s documentation may be found here: https://go.documentation.sas.com/doc/en/sasstudiocdc/default/pgmsascdc/casdlpg/cas-deeplearn-dljoin.htm\\n\\nJoin type (Required): Specifies one of the following types of table joins:\\nAPPEND\\nFULL\\nINNER\\nLEFT\\nRIGHT\\n\\nName of variable to use for the join (merge): specify the name of the variable that will be used to join tables when merging.  The ID variable name must match both tables and must not contain duplicate values in a table. \\n\\n\\nCreated / contact : \\n\\n- Robert Blanchard (robert.blanchard@sas.com)\\n\\n\\nVersion : 1.0.   (19SEP2024)\\n\\n\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t],\n\t\"syntaxversion\": \"1.3.0\",\n\t\"values\": {\n\t\t\"_jointypeoption_\": {\n\t\t\t\"value\": \"INNER\",\n\t\t\t\"label\": \"Inner\"\n\t\t},\n\t\t\"_insert_varjoin\": \"\",\n\t\t\"_Annotationtbl_\": {\n\t\t\t\"library\": \"\",\n\t\t\t\"table\": \"\"\n\t\t},\n\t\t\"insert_outtabname\": {\n\t\t\t\"library\": \"\",\n\t\t\t\"table\": \"\"\n\t\t},\n\t\t\"_inImgtbl_\": {\n\t\t\t\"library\": \"\",\n\t\t\t\"table\": \"\"\n\t\t}\n\t}\n}","templates":{"SAS":"\n/*-----------------------------------------------------------------------------------------*\n   Macro to check if a given libref belongs to a SAS or CAS engine.\n*------------------------------------------------------------------------------------------*/\n%if \"%upcase(&insert_outtabname_engine)\" ne \"CAS\" %then %do;\n\n\tdata _null_;\n\t\tputlog \"ERROR: The selected table is not a CAS table.\";\n\t\tputlog \"ERROR: Please select a library that points to a caslib.\";\n\t\tabort 42;\n\trun;\n\n%end;\n%else %do;\n\t%let _tm_nameCaslib=%sysfunc(getlcaslib(&insert_outtabname_lib));\n\t%put CASLIB name: &_tm_nameCaslib;\n%end;\n%if \"%upcase(&_annotationtbl__engine)\" ne \"CAS\" %then %do;\n\n\tdata _null_;\n\t\tputlog \"ERROR: The selected table is not a CAS table.\";\n\t\tputlog \"ERROR: Please select a library that points to a caslib.\";\n\t\tabort 42;\n\trun;\n\n%end;\n%else %do;\n\t%let _tm_nameCaslib=%sysfunc(getlcaslib(&_annotationtbl__lib));\n\t%put CASLIB name: &_tm_nameCaslib;\n%end;\n%if \"%upcase(&_inImgtbl__engine)\" ne \"CAS\" %then %do;\n\n\tdata _null_;\n\t\tputlog \"ERROR: The selected table is not a CAS table.\";\n\t\tputlog \"ERROR: Please select a library that points to a caslib.\";\n\t\tabort 42;\n\trun;\n\n%end;\n%else %do;\n\t%let _tm_nameCaslib=%sysfunc(getlcaslib(&_inImgtbl__lib));\n\t%put CASLIB name: &_tm_nameCaslib;\n%end;\n\n\n\n \n\nproc cas;\n_verify_jointype=\"&_jointypeoption_\"; /* yes no */\nif _verify_jointype = \"APPEND\" then do;\n   deepLearn.dlJoin /                                 \n      annotatedTable={name=\"&_annotationtbl__name\", caslib=\"&_annotationtbl__lib\"}\n      casOut={name=\"&insert_outtabname_name\", replace=1, caslib=\"&insert_outtabname_lib\"}\n\t\tjoinType=\"&_jointypeoption_\"\n      table={name=\"&_inImgtbl__name\", caslib=\"&_inImgtbl__lib\"};\nend;\n\n\nif _verify_jointype ne \"APPEND\" then do;\n   deepLearn.dlJoin /                                 \n      annotatedTable={name=\"&_annotationtbl__name\", caslib=\"&_annotationtbl__lib\"}\n      casOut={name=\"&insert_outtabname_name\", replace=1, caslib=\"&insert_outtabname_lib\"}\n      id=\"&_insert_varjoin\"\n\t\tjoinType=\"&_jointypeoption_\"\n      table={name=\"&_inImgtbl__name\", caslib=\"&_inImgtbl__lib\"};\nend;\nquit;\n\n\n%SYMDEL _tm_nameCaslib;\n"}}