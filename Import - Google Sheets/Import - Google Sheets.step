{"creationTimeStamp":"2023-02-15T15:42:37.648Z","modifiedTimeStamp":"2023-02-15T15:47:29.754Z","createdBy":"viyademo01","modifiedBy":"viyademo01","name":"Import - Google Sheets.step","displayName":"Import - Google Sheets.step","localDisplayName":"Import - Google Sheets.step","description":"This custom step was created by David.Weik@sas.com","localDescription":"This custom step was created by David.Weik@sas.com","properties":{},"links":[{"method":"GET","rel":"self","href":"/dataFlows/steps/bc4dbd6d-c9c2-4f71-ac17-ce94ad4c1556","uri":"/dataFlows/steps/bc4dbd6d-c9c2-4f71-ac17-ce94ad4c1556","type":"application/vnd.sas.data.flow.step"},{"method":"GET","rel":"alternate","href":"/dataFlows/steps/bc4dbd6d-c9c2-4f71-ac17-ce94ad4c1556","uri":"/dataFlows/steps/bc4dbd6d-c9c2-4f71-ac17-ce94ad4c1556","type":"application/vnd.sas.data.flow.step.summary"},{"method":"GET","rel":"up","href":"/dataFlows/steps","uri":"/dataFlows/steps","type":"application/vnd.sas.collection","itemType":"application/vnd.sas.data.flow.step.summary"},{"method":"PUT","rel":"update","href":"/dataFlows/steps/bc4dbd6d-c9c2-4f71-ac17-ce94ad4c1556","uri":"/dataFlows/steps/bc4dbd6d-c9c2-4f71-ac17-ce94ad4c1556","type":"application/vnd.sas.data.flow.step","responseType":"application/vnd.sas.data.flow.step"},{"method":"DELETE","rel":"delete","href":"/dataFlows/steps/bc4dbd6d-c9c2-4f71-ac17-ce94ad4c1556","uri":"/dataFlows/steps/bc4dbd6d-c9c2-4f71-ac17-ce94ad4c1556"},{"method":"GET","rel":"transferExport","href":"/dataFlows/steps/bc4dbd6d-c9c2-4f71-ac17-ce94ad4c1556","uri":"/dataFlows/steps/bc4dbd6d-c9c2-4f71-ac17-ce94ad4c1556","responseType":"application/vnd.sas.transfer.object"},{"method":"PUT","rel":"transferImportUpdate","href":"/dataFlows/steps/bc4dbd6d-c9c2-4f71-ac17-ce94ad4c1556","uri":"/dataFlows/steps/bc4dbd6d-c9c2-4f71-ac17-ce94ad4c1556","type":"application/vnd.sas.transfer.object","responseType":"application/vnd.sas.summary"}],"metadataVersion":0.0,"version":2,"type":"code","flowMetadata":{"inputPorts":[],"outputPorts":[{"name":"outputtable1","displayName":"outputtable1","localDisplayName":"outputtable1","minEntries":1,"maxEntries":1,"type":"table","requiresStructure":false}]},"ui":"{\n\t\"showPageContentOnly\": true,\n\t\"pages\": [\n\t\t{\n\t\t\t\"id\": \"page1\",\n\t\t\t\"type\": \"page\",\n\t\t\t\"label\": \"Definition\",\n\t\t\t\"children\": [\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"text1\",\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"The Import - Google Sheets step enables you to download any public Google Sheets document and import it as a table.\\n\\nTo import a Google Sheet, you must enter its ID. The ID can be found in the URL of the sheet, it starts after the .../d/ and continues until the next /. It is around 44 characters long and contains numbers, letters, and other common symbols.\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"sheetID\",\n\t\t\t\t\t\"type\": \"textfield\",\n\t\t\t\t\t\"label\": \"Enter the Google Sheet ID:\",\n\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"text2\",\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"Some Google Sheets contain more than one worksheet. If you want to import a worksheet other, then the first one you must enter the worksheet ID here. You can find the worksheet ID by looking at the URL, there you find a parameter called gid, enter the value of the desired worksheet. The first worksheet in a Google Sheet always has the value 0.\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"gid\",\n\t\t\t\t\t\"type\": \"numberfield\",\n\t\t\t\t\t\"label\": \"Enter the worksheet ID:\",\n\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"max\": null,\n\t\t\t\t\t\"min\": 0,\n\t\t\t\t\t\"excludemin\": false,\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"text4\",\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"Specifying the number guessing rows ensures that the full value of a column is imported. The default value is set to MAX which will effectively scan all rows, but this parameter can have a big impact on performance on large data sets, if you know that the longest value for all columns is within the first N columns that you can improve the performance by specifying N.\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"guessingrows\",\n\t\t\t\t\t\"type\": \"textfield\",\n\t\t\t\t\t\"label\": \"Specify the number of guessing rows:\",\n\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"outputtable1\",\n\t\t\t\t\t\"type\": \"outputtable\",\n\t\t\t\t\t\"label\": \"Google Sheets output table\",\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"id\": \"page2\",\n\t\t\t\"type\": \"page\",\n\t\t\t\"label\": \"About\",\n\t\t\t\"children\": [\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"text3\",\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"Import publicly available Google Sheets. Please note that Google Sheets that require an authentication are not supported by this step. That means the sharing option of the Google Sheet must be set to \\\"Anyone with the link\\\" - only viewing is required.\\n\\nThis custom step was created by David.Weik@sas.com\\n\\nVersion 1.0 (12JAN2023)\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t],\n\t\"syntaxversion\": \"1.3.0\",\n\t\"values\": {\n\t\t\"sheetID\": \"\",\n\t\t\"gid\": 0,\n\t\t\"guessingrows\": \"MAX\",\n\t\t\"outputtable1\": {\n\t\t\t\"library\": \"\",\n\t\t\t\"table\": \"\"\n\t\t}\n\t}\n}","templates":{"SAS":"* Download the Google Sheet as a csv file to work;\nfilename sheet \"%sysfunc(getoption(WORK))/sheet.csv\";\nproc http\n\turl=\"https://docs.google.com/feeds/download/spreadsheets/Export?key=&sheetID.%str(&)exportFormat=csv%str(&)gid=&gid.\"\n\tout=sheet;\nrun;\n\n* Check HTTP response code and notify the user accordingly;\ndata _null_;\n\tif &SYS_PROCHTTP_STATUS_CODE. ne 200 then do;\n\t\tstr = \"ERROR: Google Sheet could not be downloaded\";\n    \tput str;\n    \tabort abend;\n  \tend;\n  \telse put \"INFO: Google Sheet was successfully downloaded\";\nrun;\n\n* Import the csv file;\nproc import\n \tfile=sheet\n\tout=&outputtable1.\n\tdbms=csv\n\treplace;\n\tguessingrows=&guessingrows.;\nrun;\n\n* Clean up;\n%let rc = %sysfunc(fdelete(sheet));\n%symdel rc;\nfilename sheet clear;"}}