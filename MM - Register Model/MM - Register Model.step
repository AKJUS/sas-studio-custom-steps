{"type":"code","name":"MM - Register Model.step","displayName":"MM - Register Model.step","description":"","templates":{"SAS":"/* SAS templated code goes here */\n%let projectVer=%sysfunc(ifc(&newVersion.,new,));\n%let target=%sysfunc(ifc(%symexist(targetVar_1_name),%nrstr(&targetVar_1_name.),));\n%let eventProb=%sysfunc(ifc(%symexist(eventProbVar_1_name),%nrstr(&eventProbVar_1_name.),));\n%let nonEventProb= %sysfunc(ifc(%symexist(nonEvenProbVar_1_name),%nrstr(&nonEvenProbVar_1_name.),));\n%let cutStep=%sysevalf(1 / &cutoff.);\n%let testSamplePct= %sysfunc(ifc(&useTestPart.,&testSamplePct.,0));\n%let scoreOutput=%sysfunc(ifc(%symexist(scoredTable),%nrstr(&scoredTable.),));\n\n%mm_get_project_id(\n    projectNm=&projectName., \n    projectLoc=&projectLoc., \n\tidvar=myProjID\n);\n\n%mm_import_astore_model(\n    rstore=&astore.,\n    locationID=%str(&myprojID), \n    modelname=&modelName., \n\tmodeldesc=&modelDesc., \n    projectVersion=&projectVer., \n\tscoredata=&scoreOutput., \n    nBins=&numbins. , \n    cutStep=&cutStep., \n    maxIters=&maxIter. , \n\ttarget=&target., \n    event=&targetEvent., \n    targetLevel=&targetLevel., \n    eventProbVar=&eventProb., \n\tnonEventProbVar=&nonEventProb., \n    nonEvent=&nonTargetEvent., \n    samplePct=&trainSamplePct., \n    samplePct2=&testSamplePct., \n\tsampleSeed=&sampleSeed. \n);\n\nproc delete data=work.__ITEMS; run;\nproc delete data=work._NLITERAL_; run;\nproc delete data=work._AUXTABLE_; run;\n"},"properties":{},"ui":"{\n\t\"showPageContentOnly\": true,\n\t\"pages\": [\n\t\t{\n\t\t\t\"id\": \"modelTab\",\n\t\t\t\"type\": \"page\",\n\t\t\t\"label\": \"Model\",\n\t\t\t\"children\": [\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"model\",\n\t\t\t\t\t\"type\": \"section\",\n\t\t\t\t\t\"label\": \"Model\",\n\t\t\t\t\t\"open\": true,\n\t\t\t\t\t\"visible\": \"\",\n\t\t\t\t\t\"children\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"astore\",\n\t\t\t\t\t\t\t\"type\": \"inputtable\",\n\t\t\t\t\t\t\t\"label\": \"Specify a CAS table that contains an analytic store.\",\n\t\t\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"modelName\",\n\t\t\t\t\t\t\t\"type\": \"textarea\",\n\t\t\t\t\t\t\t\"label\": \"Name\",\n\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\t\t\"visible\": \"$astore\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"modelDesc\",\n\t\t\t\t\t\t\t\"type\": \"textarea\",\n\t\t\t\t\t\t\t\"label\": \"Description\",\n\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"project\",\n\t\t\t\t\t\"type\": \"section\",\n\t\t\t\t\t\"label\": \"SAS Model Manager\",\n\t\t\t\t\t\"open\": true,\n\t\t\t\t\t\"visible\": \"\",\n\t\t\t\t\t\"children\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"projectName\",\n\t\t\t\t\t\t\t\"type\": \"textarea\",\n\t\t\t\t\t\t\t\"label\": \"Project name\",\n\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"projectLoc\",\n\t\t\t\t\t\t\t\"type\": \"textarea\",\n\t\t\t\t\t\t\t\"label\": \"Project location\",\n\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"newVersion\",\n\t\t\t\t\t\t\t\"type\": \"checkbox\",\n\t\t\t\t\t\t\t\"label\": \"New project version\",\n\t\t\t\t\t\t\t\"visible\": \"$projectName\"\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"id\": \"dataTab\",\n\t\t\t\"type\": \"page\",\n\t\t\t\"label\": \"Data\",\n\t\t\t\"children\": [\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"dataSec\",\n\t\t\t\t\t\"type\": \"section\",\n\t\t\t\t\t\"label\": \"Data\",\n\t\t\t\t\t\"open\": false,\n\t\t\t\t\t\"visible\": true,\n\t\t\t\t\t\"children\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"scoredTable\",\n\t\t\t\t\t\t\t\"type\": \"inputtable\",\n\t\t\t\t\t\t\t\"label\": \"Specify scored CAS table:\",\n\t\t\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\"visible\": true\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"roleSec\",\n\t\t\t\t\t\"type\": \"section\",\n\t\t\t\t\t\"label\": \"Roles\",\n\t\t\t\t\t\"open\": false,\n\t\t\t\t\t\"visible\": \"$scoredTable\",\n\t\t\t\t\t\"children\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"targetLevel\",\n\t\t\t\t\t\t\t\"type\": \"radiogroup\",\n\t\t\t\t\t\t\t\"label\": \"\",\n\t\t\t\t\t\t\t\"items\": [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"binary\",\n\t\t\t\t\t\t\t\t\t\"label\": \"Use a binary target\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\"visible\": \"$scoredTable\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"targetVar\",\n\t\t\t\t\t\t\t\"type\": \"columnselector\",\n\t\t\t\t\t\t\t\"label\": \"Target:\",\n\t\t\t\t\t\t\t\"order\": false,\n\t\t\t\t\t\t\t\"columntype\": \"a\",\n\t\t\t\t\t\t\t\"max\": 1,\n\t\t\t\t\t\t\t\"min\": 1,\n\t\t\t\t\t\t\t\"visible\": \"$scoredTable\",\n\t\t\t\t\t\t\t\"table\": \"scoredTable\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"targetEvent\",\n\t\t\t\t\t\t\t\"type\": \"dropdown\",\n\t\t\t\t\t\t\t\"label\": \"Event level of target:\",\n\t\t\t\t\t\t\t\"items\": {\n\t\t\t\t\t\t\t\t\"ref\": \"targetVar\"\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\"visible\": \"$targetVar\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"eventProbVar\",\n\t\t\t\t\t\t\t\"type\": \"columnselector\",\n\t\t\t\t\t\t\t\"label\": \"Posterior probability of target event:\",\n\t\t\t\t\t\t\t\"order\": false,\n\t\t\t\t\t\t\t\"columntype\": \"n\",\n\t\t\t\t\t\t\t\"max\": 1,\n\t\t\t\t\t\t\t\"min\": 1,\n\t\t\t\t\t\t\t\"visible\": \"$scoredTable\",\n\t\t\t\t\t\t\t\"table\": \"scoredTable\"\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"partitionSec\",\n\t\t\t\t\t\"type\": \"section\",\n\t\t\t\t\t\"label\": \"Partitions\",\n\t\t\t\t\t\"open\": false,\n\t\t\t\t\t\"visible\": \"$scoredTable\",\n\t\t\t\t\t\"children\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"useTrainPart\",\n\t\t\t\t\t\t\t\"type\": \"checkbox\",\n\t\t\t\t\t\t\t\"label\": \"Training partition\",\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"trainSamplePct\",\n\t\t\t\t\t\t\t\"type\": \"textfield\",\n\t\t\t\t\t\t\t\"label\": \"Sampling percentage for the training partition:\",\n\t\t\t\t\t\t\t\"regexp\": \"^(100|[1-9][0-9]?)$\",\n\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\t\t\"visible\": \"$useTrainPart\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"useTestPart\",\n\t\t\t\t\t\t\t\"type\": \"checkbox\",\n\t\t\t\t\t\t\t\"label\": \"Test partition\",\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"testSamplePct\",\n\t\t\t\t\t\t\t\"type\": \"textfield\",\n\t\t\t\t\t\t\t\"label\": \"Sampling percentage for the test partition:\",\n\t\t\t\t\t\t\t\"regexp\": \"^(100|[1-9][0-9]?)$\",\n\t\t\t\t\t\t\t\"placeholder\": \"40\",\n\t\t\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\t\t\"visible\": \"$useTestPart\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"testPartNote\",\n\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\"text\": \"Note: The test partition consists of unsampled cases.\",\n\t\t\t\t\t\t\t\"visible\": \"$useTrainPart\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"sampleSeed\",\n\t\t\t\t\t\t\t\"type\": \"numberfield\",\n\t\t\t\t\t\t\t\"label\": \"Random seed:\",\n\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\t\t\"max\": null,\n\t\t\t\t\t\t\t\"min\": null,\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"seedNote\",\n\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\"text\": \"Note: Specifying a value for the random seed might not replicate results in a distributed computing environment.\",\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"id\": \"optionTab\",\n\t\t\t\"type\": \"page\",\n\t\t\t\"label\": \"Options\",\n\t\t\t\"children\": [\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"liftSec\",\n\t\t\t\t\t\"type\": \"section\",\n\t\t\t\t\t\"label\": \"Lift Analysis\",\n\t\t\t\t\t\"open\": true,\n\t\t\t\t\t\"visible\": \"$scoredTable\",\n\t\t\t\t\t\"children\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"numbins\",\n\t\t\t\t\t\t\t\"type\": \"dropdown\",\n\t\t\t\t\t\t\t\"label\": \"Lift curve type:\",\n\t\t\t\t\t\t\t\"items\": [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"20\",\n\t\t\t\t\t\t\t\t\t\"label\": \"Semi-decile\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\"value\": \"10\",\n\t\t\t\t\t\t\t\t\t\"label\": \"Decile\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"maxIter\",\n\t\t\t\t\t\t\t\"type\": \"numberfield\",\n\t\t\t\t\t\t\t\"label\": \"Maximum number of iterations:\",\n\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\t\t\"max\": null,\n\t\t\t\t\t\t\t\"min\": 0,\n\t\t\t\t\t\t\t\"excludemin\": true,\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"rocSec\",\n\t\t\t\t\t\"type\": \"section\",\n\t\t\t\t\t\"label\": \"ROC Analysis\",\n\t\t\t\t\t\"open\": true,\n\t\t\t\t\t\"visible\": \"$scoredTable\",\n\t\t\t\t\t\"children\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"cutoff\",\n\t\t\t\t\t\t\t\"type\": \"numstepper\",\n\t\t\t\t\t\t\t\"label\": \"Increase cutoff probability from 0 to 1 by:\",\n\t\t\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\t\t\"integer\": false,\n\t\t\t\t\t\t\t\"min\": 0.01,\n\t\t\t\t\t\t\t\"max\": 0.2,\n\t\t\t\t\t\t\t\"stepsize\": 0.01\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"fitstatSec\",\n\t\t\t\t\t\"type\": \"section\",\n\t\t\t\t\t\"label\": \"Fit Statistics\",\n\t\t\t\t\t\"open\": true,\n\t\t\t\t\t\"visible\": \"$scoredTable\",\n\t\t\t\t\t\"children\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"nonEvenProbVar\",\n\t\t\t\t\t\t\t\"type\": \"columnselector\",\n\t\t\t\t\t\t\t\"label\": \"Posterior probability of target non-event:\",\n\t\t\t\t\t\t\t\"order\": false,\n\t\t\t\t\t\t\t\"columntype\": \"n\",\n\t\t\t\t\t\t\t\"max\": 1,\n\t\t\t\t\t\t\t\"min\": 1,\n\t\t\t\t\t\t\t\"visible\": \"\",\n\t\t\t\t\t\t\t\"table\": \"scoredTable\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"nonTargetEvent\",\n\t\t\t\t\t\t\t\"type\": \"dropdown\",\n\t\t\t\t\t\t\t\"label\": \"Non-event level of target:\",\n\t\t\t\t\t\t\t\"items\": {\n\t\t\t\t\t\t\t\t\"ref\": \"targetVar\"\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\"visible\": \"$nonEvenProbVar\"\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"id\": \"aboutTab\",\n\t\t\t\"type\": \"page\",\n\t\t\t\"label\": \"About\",\n\t\t\t\"children\": [\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"aboutNote\",\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"The Model Manager (MM) - Register Model step allows user to register an analytic store model into a project of SAS Model Manager.\\n\\n* Register model into \\\"latest\\\" project version by default.\\n* Register model into a \\\"new\\\" project version if the checkbox is selected.\\n* Generate model comparison JSON files if scored data is provided and related options are specifed.\\n* This step will execute on the SAS Compute Server using SAS Model Manager Public Macros. \\n\\nThe related public macros are documented here: https://go.documentation.sas.com/doc/en/mdlmgrcdc/default/mdlmgrmacro/p0afa8wptbbkr6n1vtwax8nbifm4.htm.\\n\\nCreated / contact: Jacky (Kun) Jia (kun.jia@sas.com)\\n\\nVersion : 1.0.   (26DEC2022)\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t],\n\t\"syntaxversion\": \"1.3.0\",\n\t\"values\": {\n\t\t\"astore\": {\n\t\t\t\"library\": \"\",\n\t\t\t\"table\": \"\"\n\t\t},\n\t\t\"modelName\": \"Model 1\",\n\t\t\"modelDesc\": \"model register from custom step\",\n\t\t\"projectName\": \"\",\n\t\t\"projectLoc\": \"Public\",\n\t\t\"newVersion\": false,\n\t\t\"scoredTable\": {\n\t\t\t\"library\": \"\",\n\t\t\t\"table\": \"\"\n\t\t},\n\t\t\"targetLevel\": {\n\t\t\t\"value\": \"binary\",\n\t\t\t\"label\": \"Use a binary target\"\n\t\t},\n\t\t\"targetVar\": [],\n\t\t\"targetEvent\": {\n\t\t\t\"value\": \"1\"\n\t\t},\n\t\t\"eventProbVar\": [],\n\t\t\"useTrainPart\": true,\n\t\t\"trainSamplePct\": \"30\",\n\t\t\"useTestPart\": false,\n\t\t\"testSamplePct\": \"\",\n\t\t\"sampleSeed\": 1234,\n\t\t\"numbins\": {\n\t\t\t\"value\": \"20\",\n\t\t\t\"label\": \"Semi-decile\"\n\t\t},\n\t\t\"maxIter\": 50,\n\t\t\"cutoff\": 0.05,\n\t\t\"nonEvenProbVar\": [],\n\t\t\"nonTargetEvent\": {\n\t\t\t\"value\": \"0\"\n\t\t}\n\t}\n}","flowMetadata":{"inputPorts":[{"name":"astore","displayName":"astore","minEntries":1,"maxEntries":1,"type":"table"},{"name":"scoredTable","displayName":"scoredTable","minEntries":0,"maxEntries":1,"type":"table"}],"outputPorts":[]}}